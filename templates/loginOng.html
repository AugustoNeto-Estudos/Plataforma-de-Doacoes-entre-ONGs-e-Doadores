<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>SolidariHub - Login/Cadastro ONG</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styleLoginONG.css') }}">
</head>
<body>
  <div class="container">
    <!-- LOGIN ONG -->
    <div class="form-section" id="login-form-section">
      <div class="logo">
        <img src="{{ url_for('static', filename='img/SolidariHub_logo_escrito_azul.png') }}" 
            alt="SolidariHub" class="logo-img">
      </div>
      <h2>Login de ONGs</h2>

      {% with messages = get_flashed_messages() %}
        {% if messages %}
          <ul class="flash-messages">
            {% for msg in messages %}
              <li>{{ msg }}</li>
            {% endfor %}
          </ul>
        {% endif %}
      {% endwith %}

      <form method="POST" action="/LoginONG">
        <input type="hidden" name="acao" value="login">
        <input type="email" name="email" placeholder="Email da ONG" required>

        <div class="password-container">
          <input type="password" name="senha" placeholder="Senha" id="login-senha" required>
          <img src="{{ url_for('static', filename='img/icone-oculte.png') }}" 
               alt="Mostrar/ocultar senha" 
               class="toggle-password" 
               data-target="login-senha">
        </div>

        <button type="submit" class="btn">Entrar</button>
      </form>

      <a href="{{ url_for('recuperar_senha.recuperar_senha') }}" class="link">Esqueceu sua senha?</a>
      <hr>
      <p>Ainda não tem conta?</p>
      <a href="#" onclick="mostrarCadastro()" class="btn-secondary">Cadastre sua ONG</a>
    </div>

    <div class="image-section" id="image-login"></div>

    <!-- CADASTRO ONG -->
    <div class="image-section" id="image-cadastro" style="display:none;"></div>
    <div class="form-section" id="cadastro-form-section" style="display:none;">
      <div class="logo">
        <img src="{{ url_for('static', filename='img/SolidariHub_logo_escrito_azul.png') }}" 
            alt="SolidariHub" class="logo-img">
      </div>
      <h2>Cadastro de ONGs</h2>

      {% with messages = get_flashed_messages() %}
        {% if messages %}
          <ul class="flash-messages">
            {% for msg in messages %}
              <li>{{ msg }}</li>
            {% endfor %}
          </ul>
        {% endif %}
      {% endwith %}
      <form method="POST" action="/LoginONG">
        <input type="hidden" name="acao" value="cadastro">
        <input type="text" name="cnpj" placeholder="CNPJ (somente números)" required>
        <input type="text" name="nome" placeholder="Nome da Instituição" required>
        <input type="text" name="cep" placeholder="CEP (somente números)">
        <input type="tel" name="contato" placeholder="Contato (DDD+Número)">
        <input type="email" name="email" placeholder="Email" required>

        <div class="password-container">
          <input type="password" name="senha" placeholder="Senha" id="cadastro-senha" required>
          <img src="{{ url_for('static', filename='img/icone-oculte.png') }}" 
               alt="Mostrar/ocultar senha" 
               class="toggle-password" 
               data-target="cadastro-senha">
        </div>

        <div class="password-container">
          <input type="password" name="confirmar_senha" placeholder="Confirme sua senha" id="cadastro-confirmar" required>
          <img src="{{ url_for('static', filename='img/icone-oculte.png') }}" 
               alt="Mostrar/ocultar senha" 
               class="toggle-password" 
               data-target="cadastro-confirmar">
        </div>

        <textarea name="descricao" placeholder="Descrição da Instituição"></textarea>
        <button type="submit" class="btn">Cadastrar</button>
      </form>

      <hr>
      <p>Já tem conta?</p>
      <a href="#" onclick="mostrarLogin()" class="btn-secondary">Voltar para Login</a>
    </div>
  </div>

  <!-- MODAL DE CONSENTIMENTO -->
  <div id="modal-termos" class="modal-overlay" style="display:none;">
    <div class="modal-content">
      <button id="fechar-modal" class="fechar-modal">✖</button>
      <h3>Antes de continuar…</h3>
      <p>Ao cadastrar sua ONG no SolidariHub, você confirma que leu e concorda com nossos 
        <a href="/termo.html" target="_blank">Termos de Uso</a> e 
        <a href="/termo.html" target="_blank">Política de Privacidade</a>.
      </p>
      <label>
        <input type="checkbox" id="aceite-termos"> Eu aceito os termos e políticas
      </label>
      <br>
      <button id="btn-continuar" class="btn-continuar" disabled>Continuar para Cadastro</button>
    </div>
  </div>

  <script>
    function mostrarCadastro() {
      document.getElementById("modal-termos").style.display = "flex";
    }

    function mostrarLogin() {
      document.getElementById("modal-termos").style.display = "none";
      document.getElementById("cadastro-form-section").style.display = "none";
      document.getElementById("image-cadastro").style.display = "none";
      document.getElementById("login-form-section").style.display = "flex";
      document.getElementById("image-login").style.display = "block";

      const formCadastro = document.querySelector('#cadastro-form-section form');
      if (formCadastro) formCadastro.reset();

      document.getElementById("aceite-termos").checked = false;
      document.getElementById("btn-continuar").disabled = true;
    }

    document.addEventListener("DOMContentLoaded", () => {
      const checkbox = document.getElementById("aceite-termos");
      const btnContinuar = document.getElementById("btn-continuar");
      const btnFechar = document.getElementById("fechar-modal");

      checkbox.addEventListener("change", () => {
        btnContinuar.disabled = !checkbox.checked;
      });

      btnContinuar.addEventListener("click", () => {
        document.getElementById("modal-termos").style.display = "none";
        document.getElementById("login-form-section").style.display = "none";
        document.getElementById("image-login").style.display = "none";
        document.getElementById("cadastro-form-section").style.display = "flex";
        document.getElementById("image-cadastro").style.display = "block";
      });

      btnFechar.addEventListener("click", () => {
        mostrarLogin();
      });

      document.querySelectorAll(".toggle-password").forEach(icon => {
        icon.addEventListener("click", () => {
          const targetId = icon.getAttribute("data-target");
          const input = document.getElementById(targetId);

          if (input.type === "password") {
            input.type = "text";
            icon.src = "{{ url_for('static', filename='img/icone-olho.png') }}";
          } else {
            input.type = "password";
            icon.src = "{{ url_for('static', filename='img/icone-oculte.png') }}";
          }
        });
      });
    });
  </script>

  {% if mostrar_cadastro %}
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      mostrarCadastro();
    });
  </script>
  {% endif %}
</body>
</html>
